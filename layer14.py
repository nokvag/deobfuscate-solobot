u1KQ2EguJKQ7 = lambda UWdGO89tcyS7: bytes([Sa8e3lqr_V8J ^ [52, 110, 239, 144, 44, 41, 159, 75, 3, 6, 111, 45, 15, 232, 5, 136, 186, 101, 136, 199, 76, 59, 74, 28, 139, 166, 10, 120, 93, 139, 58, 48, 248, 136, 234, 128, 174, 58, 109, 129][Dihj1QYMQ6NC % 40] for (Dihj1QYMQ6NC, Sa8e3lqr_V8J) in enumerate(UWdGO89tcyS7)])

def slBqQzRHEsUg(I3TrM73hju6F, sXfSEpzNzWP5, *AWcbN0PPHoI1, **RSLz52gI66iZ):
    try:
        return __import__(I3TrM73hju6F + '.' + sXfSEpzNzWP5, *AWcbN0PPHoI1, **RSLz52gI66iZ)
    except ImportError:
        return __import__(I3TrM73hju6F, *AWcbN0PPHoI1, **RSLz52gI66iZ)
(diyel4O5bMLs,) = (__import__('asyncio'),)
(pqP1JQ7q8C2M,) = (__import__('signal'),)
(m0HGG4fFzMqQ, LUxf4g0U9GW3) = (getattr(getattr(getattr(slBqQzRHEsUg('aiogram.webhook.aiohttp_server', 'SimpleRequestHandler', globals=None, locals=None, level=0), 'webhook'), 'aiohttp_server'), 'SimpleRequestHandler'), getattr(getattr(getattr(slBqQzRHEsUg('aiogram.webhook.aiohttp_server', 'setup_application', globals=None, locals=None, level=0), 'webhook'), 'aiohttp_server'), 'setup_application'))
(fq44kslIKKlh,) = (getattr(slBqQzRHEsUg('aiohttp', 'web', globals=None, locals=None, level=0), 'web'),)
(CixZZL1caaDz,) = (getattr(slBqQzRHEsUg('backup', 'backup_database', globals=None, locals=None, level=0), 'backup_database'),)
(GiFJytvAvueM, _dIJgk7A3AIg) = (getattr(slBqQzRHEsUg('bot', 'bot', globals=None, locals=None, level=0), 'bot'), getattr(slBqQzRHEsUg('bot', 'dp', globals=None, locals=None, level=0), 'dp'))
(a5c3UP8TmpNy, osp164bN12E4, VWiaMPSC0NzU, DfumMdwt5gQ6, fqoAVnVIRd_I, K585qaYUbA_y, iWt7SquS5uxf, LDZldmpRRXTP, jpvzaVV9Pk2G, Di3ZYNq4y1Jk, sDa0ySHsUBbE, U3RbnQ1KQ4Bf, QnsUyBGFs1xi) = (getattr(slBqQzRHEsUg('config', 'BACKUP_TIME', globals=None, locals=None, level=0), 'BACKUP_TIME'), getattr(slBqQzRHEsUg('config', 'CRYPTO_BOT_ENABLE', globals=None, locals=None, level=0), 'CRYPTO_BOT_ENABLE'), getattr(slBqQzRHEsUg('config', 'DEV_MODE', globals=None, locals=None, level=0), 'DEV_MODE'), getattr(slBqQzRHEsUg('config', 'LEGACY_ENABLE', globals=None, locals=None, level=0), 'LEGACY_ENABLE'), getattr(slBqQzRHEsUg('config', 'ROBOKASSA_ENABLE', globals=None, locals=None, level=0), 'ROBOKASSA_ENABLE'), getattr(slBqQzRHEsUg('config', 'SUB_PATH', globals=None, locals=None, level=0), 'SUB_PATH'), getattr(slBqQzRHEsUg('config', 'WEBAPP_HOST', globals=None, locals=None, level=0), 'WEBAPP_HOST'), getattr(slBqQzRHEsUg('config', 'WEBAPP_PORT', globals=None, locals=None, level=0), 'WEBAPP_PORT'), getattr(slBqQzRHEsUg('config', 'WEBHOOK_PATH', globals=None, locals=None, level=0), 'WEBHOOK_PATH'), getattr(slBqQzRHEsUg('config', 'WEBHOOK_URL', globals=None, locals=None, level=0), 'WEBHOOK_URL'), getattr(slBqQzRHEsUg('config', 'YOOKASSA_ENABLE', globals=None, locals=None, level=0), 'YOOKASSA_ENABLE'), getattr(slBqQzRHEsUg('config', 'YOOMONEY_ENABLE', globals=None, locals=None, level=0), 'YOOMONEY_ENABLE'), getattr(slBqQzRHEsUg('config', 'PING_TIME', globals=None, locals=None, level=0), 'PING_TIME'))
(mhwkmweqvIZS,) = (getattr(slBqQzRHEsUg('database', 'init_db', globals=None, locals=None, level=0), 'init_db'),)
(vlARRACoCOHo,) = (getattr(slBqQzRHEsUg('handlers', 'router', globals=None, locals=None, level=0), 'router'),)
(hQCziMO4TGCZ, CjTWspeGMliC) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.keys.subscriptions', 'handle_new_subscription', globals=None, locals=None, level=0), 'keys'), 'subscriptions'), 'handle_new_subscription'), getattr(getattr(getattr(slBqQzRHEsUg('handlers.keys.subscriptions', 'handle_old_subscription', globals=None, locals=None, level=0), 'keys'), 'subscriptions'), 'handle_old_subscription'))
(fLL8E8IGPK8S,) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.notifications.general_notifications', 'periodic_notifications', globals=None, locals=None, level=0), 'notifications'), 'general_notifications'), 'periodic_notifications'),)
(URH6xO9_OvAX,) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.cryprobot_pay', 'cryptobot_webhook', globals=None, locals=None, level=0), 'payments'), 'cryprobot_pay'), 'cryptobot_webhook'),)
(r1KJRGSk6S_M,) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.gift', 'validate_client_code', globals=None, locals=None, level=0), 'payments'), 'gift'), 'validate_client_code'),)
(eVzbKhmdRT7G,) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.robokassa_pay', 'robokassa_webhook', globals=None, locals=None, level=0), 'payments'), 'robokassa_pay'), 'robokassa_webhook'),)
(FMmGOBZBev8A, gLLuUhpdiNZQ) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.yookassa_pay', 'MAIN_SECRET', globals=None, locals=None, level=0), 'payments'), 'yookassa_pay'), 'MAIN_SECRET'), getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.yookassa_pay', 'yookassa_webhook', globals=None, locals=None, level=0), 'payments'), 'yookassa_pay'), 'yookassa_webhook'))
(FHt_8BTqROto,) = (getattr(getattr(getattr(slBqQzRHEsUg('handlers.payments.yoomoney_pay', 'yoomoney_webhook', globals=None, locals=None, level=0), 'payments'), 'yoomoney_pay'), 'yoomoney_webhook'),)
(zcptFAL0yWNU,) = (getattr(slBqQzRHEsUg('logger', 'logger', globals=None, locals=None, level=0), 'logger'),)
(I9T087Aiov_5,) = (getattr(slBqQzRHEsUg('servers', 'check_servers', globals=None, locals=None, level=0), 'check_servers'),)
(KTcuB6QKV8WZ,) = (__import__('os'),)
(gtWK63WYa3JX,) = (__import__('sys'),)

def QK5bLxBOypkF():
    NufvPSR1AQNx = KTcuB6QKV8WZ.path.abspath('cli_launcher.py')
    lsHnbTESTPag = gtWK63WYa3JX.executable
    u4Kgw2xftrng = ['/usr/local/bin', '/usr/bin', KTcuB6QKV8WZ.path.expanduser('~/.local/bin')]
    for LjLi2w1n0i3h in u4Kgw2xftrng:
        if KTcuB6QKV8WZ.path.isdir(LjLi2w1n0i3h) and KTcuB6QKV8WZ.access(LjLi2w1n0i3h, getattr(KTcuB6QKV8WZ, 'W_OK')):
            DK9LsyO02L_J = KTcuB6QKV8WZ.path.join(LjLi2w1n0i3h, 'solobot')
            break
    else:
        print('❌ Не удалось найти подходящий каталог для установки команды `solobot`.')
        return
    if KTcuB6QKV8WZ.path.exists(DK9LsyO02L_J):
        return
    try:
        with open(DK9LsyO02L_J, 'w') as HohFPgdHHRgg:
            HohFPgdHHRgg.write(f"""#!/bin/bash\n'{lsHnbTESTPag}' '{NufvPSR1AQNx}' "$@"\n""")
        KTcuB6QKV8WZ.chmod(DK9LsyO02L_J, 493)
        print(fchr(9989) + ' ' + 'К' + 'о' + 'м' + 'а' + 'н' + 'д' + 'а' + ' ' + '`' + 's' + 'o' + 'l' + 'o' + 'b' + 'o' + 't' + '`' + ' ' + 'у' + 'с' + 'т' + 'а' + 'н' + 'о' + 'в' + 'л' + 'е' + 'н' + 'а' + '!' + ' ' + 'И' + 'с' + 'п' + 'о' + 'л' + 'ь' + 'з' + 'у' + 'й' + 'т' + 'е' + ':' + ' ' + 's' + 'o' + 'l' + 'o' + 'b' + 'o' + 't')
    except Exception as hsEaj3FbHlV3:
        print(f'❌ Ошибка установки команды solobot: {hsEaj3FbHlV3}')

async def D6P0eecBAFVv():
    while 1:
        await CixZZL1caaDz()
        await diyel4O5bMLs.sleep(a5c3UP8TmpNy)

async def M6flxKL4gRoX(lqCBDe1lOEOd):
    await GiFJytvAvueM.set_webhook(Di3ZYNq4y1Jk)
    await mhwkmweqvIZS()
    diyel4O5bMLs.create_task(fLL8E8IGPK8S(GiFJytvAvueM))
    if a5c3UP8TmpNy > 0:
        diyel4O5bMLs.create_task(D6P0eecBAFVv())
    if QnsUyBGFs1xi > 0:
        diyel4O5bMLs.create_task(I9T087Aiov_5())

async def KMS7j9IC8wK5(lqCBDe1lOEOd):
    await GiFJytvAvueM.delete_webhook()
    for NwVNoYZ0lVgA in diyel4O5bMLs.all_tasks():
        NwVNoYZ0lVgA.cancel()
    try:
        await diyel4O5bMLs.gather(*diyel4O5bMLs.all_tasks(), return_exceptions=1)
    except Exception as hsEaj3FbHlV3:
        zcptFAL0yWNU.error(f'Ошибка при завершении работы: {hsEaj3FbHlV3}')

async def o_Zg3SYZ2U_F(JutrLWyLwTzT):
    zcptFAL0yWNU.info('Остановка вебхуков...')
    await JutrLWyLwTzT.stop()
    zcptFAL0yWNU.info('Остановка бота.')

async def WeQFJHP3LH_W():
    _SvfhKl8rD1_ = await r1KJRGSk6S_M()
    if not _SvfhKl8rD1_:
        zcptFAL0yWNU.error('Бот не активирован. Проверьте ваш клиентский код.')
        return
    JezwpIWfYHOX = 'SOLO-ACCESS-KEY-B4TN-92QX-L7ME'
    if FMmGOBZBev8A != JezwpIWfYHOX:
        zcptFAL0yWNU.error('Нарушена целостность файлов! Обновитесь с полной заменой папки!')
        return
    _dIJgk7A3AIg.include_router(vlARRACoCOHo)
    if VWiaMPSC0NzU:
        zcptFAL0yWNU.info('Запуск в режиме разработки...')
        await GiFJytvAvueM.delete_webhook()
        await mhwkmweqvIZS()
        fPSFiLwtmvLO = [diyel4O5bMLs.create_task(fLL8E8IGPK8S(GiFJytvAvueM))]
        if QnsUyBGFs1xi > 0:
            fPSFiLwtmvLO.append(diyel4O5bMLs.create_task(I9T087Aiov_5()))
        if a5c3UP8TmpNy > 0:
            fPSFiLwtmvLO.append(diyel4O5bMLs.create_task(D6P0eecBAFVv()))
        await _dIJgk7A3AIg.start_polling(GiFJytvAvueM)
        zcptFAL0yWNU.info('Polling остановлен в режиме разработки. Отмена фоновых задач...')
        for NwVNoYZ0lVgA in fPSFiLwtmvLO:
            NwVNoYZ0lVgA.cancel()
        await diyel4O5bMLs.gather(*fPSFiLwtmvLO, return_exceptions=1)
    else:
        zcptFAL0yWNU.info('Запуск в production режиме...')
        lqCBDe1lOEOd = fq44kslIKKlh.Application()
        lqCBDe1lOEOd.on_startup.append(M6flxKL4gRoX)
        lqCBDe1lOEOd.on_shutdown.append(KMS7j9IC8wK5)
        if sDa0ySHsUBbE:
            lqCBDe1lOEOd.router.add_post('/yookassa/webhook', gLLuUhpdiNZQ)
        if U3RbnQ1KQ4Bf:
            lqCBDe1lOEOd.router.add_post('/yoomoney/webhook', FHt_8BTqROto)
        if osp164bN12E4:
            lqCBDe1lOEOd.router.add_post('/cryptobot/webhook', URH6xO9_OvAX)
        if fqoAVnVIRd_I:
            lqCBDe1lOEOd.router.add_post('/robokassa/webhook', eVzbKhmdRT7G)
        if DfumMdwt5gQ6:
            lqCBDe1lOEOd.router.add_get(f'{K585qaYUbA_y}{{email}}', CjTWspeGMliC)
        lqCBDe1lOEOd.router.add_get(f'{K585qaYUbA_y}{{email}}/{{tg_id}}', hQCziMO4TGCZ)
        m0HGG4fFzMqQ(dispatcher=_dIJgk7A3AIg, bot=GiFJytvAvueM).register(lqCBDe1lOEOd, path=jpvzaVV9Pk2G)
        LUxf4g0U9GW3(lqCBDe1lOEOd, _dIJgk7A3AIg, bot=GiFJytvAvueM)
        VEYmCcpb5WZi = fq44kslIKKlh.AppRunner(lqCBDe1lOEOd)
        await VEYmCcpb5WZi.setup()
        JutrLWyLwTzT = fq44kslIKKlh.TCPSite(VEYmCcpb5WZi, host=iWt7SquS5uxf, port=LDZldmpRRXTP)
        await JutrLWyLwTzT.start()
        zcptFAL0yWNU.info(f'URL вебхука: {Di3ZYNq4y1Jk}')
        CRZYKFwfFJRI = diyel4O5bMLs.Event()
        SoAy9XMB2LZJ = diyel4O5bMLs.get_event_loop()
        for aIut2Xl7LjBC in (getattr(pqP1JQ7q8C2M, 'SIGINT'), getattr(pqP1JQ7q8C2M, 'SIGTERM')):
            SoAy9XMB2LZJ.add_signal_handler(aIut2Xl7LjBC, getattr(CRZYKFwfFJRI, 'set'))
        try:
            await CRZYKFwfFJRI.wait()
        finally:
            g5gb1yodGaJT = [NwVNoYZ0lVgA for NwVNoYZ0lVgA in diyel4O5bMLs.all_tasks() if NwVNoYZ0lVgA is not diyel4O5bMLs.current_task()]
            for NwVNoYZ0lVgA in g5gb1yodGaJT:
                try:
                    NwVNoYZ0lVgA.cancel()
                except Exception as hsEaj3FbHlV3:
                    zcptFAL0yWNU.error(hsEaj3FbHlV3)
            await diyel4O5bMLs.gather(*g5gb1yodGaJT, return_exceptions=1)
if __name__ == '__main__':
    QK5bLxBOypkF()
    try:
        diyel4O5bMLs.run(WeQFJHP3LH_W())
    except Exception as hsEaj3FbHlV3:
        zcptFAL0yWNU.error(f'Ошибка при запуске приложения:\n{hsEaj3FbHlV3}')